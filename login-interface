#!/bin/bash

# Setup script for login-interface project

# Secure and private directory setup
PROJECT_DIR="/data/data/com.termux/files/home/login-interface"
mkdir -p $PROJECT_DIR
cd $PROJECT_DIR

# Update the local repository with the latest code from GitHub
echo "Fetching the latest updates from GitHub..."
git pull origin main

# Ensure dependencies are installed
echo "Checking dependencies..."

# Install necessary packages
pkg update && pkg upgrade -y
pkg install -y git curl wget openssl bash

# Function to initialize the login process
login() {
    clear
    echo "====================================="
    echo "      Secure Login Interface"
    echo "====================================="
    echo -n "Enter your username: "
    read username
    echo -n "Enter your password: "
    read -s password
    echo

    # Verify login (this part can be customized based on your setup)
    if [[ $username == "admin" && $password == "admin123" ]]; then
        echo "Login successful!"
        main_menu
    else
        echo "Invalid username or password. Try again."
        login
    fi
}

# Function to initialize the main menu options
main_menu() {
    clear
    echo "====================================="
    echo "      Welcome to Login-Interface"
    echo "====================================="
    echo "1. Project"
    echo "2. Tools"
    echo "3. Google Search"
    echo "4. Exit"
    echo "====================================="
    echo -n "Select an option: "
    read option
    case $option in
        1)
            project_menu
            ;;
        2)
            tools_menu
            ;;
        3)
            google_search
            ;;
        4)
            exit
            ;;
        *)
            echo "Invalid option, try again."
            main_menu
            ;;
    esac
}

# Project menu
project_menu() {
    clear
    echo "====================================="
    echo "            Project Options"
    echo "====================================="
    echo "1. Clone New Repository"
    echo "2. View All Repositories"
    echo "3. Return to Main Menu"
    echo "====================================="
    echo -n "Select an option: "
    read option
    case $option in
        1)
            clone_new_repository
            ;;
        2)
            view_repositories
            ;;
        3)
            main_menu
            ;;
        *)
            echo "Invalid option, try again."
            project_menu
            ;;
    esac
}

# Tools menu
tools_menu() {
    clear
    echo "====================================="
    echo "           Tools Options"
    echo "====================================="
    echo "1. Open All Repositories"
    echo "2. Return to Main Menu"
    echo "====================================="
    echo -n "Select an option: "
    read option
    case $option in
        1)
            open_all_repositories
            ;;
        2)
            main_menu
            ;;
        *)
            echo "Invalid option, try again."
            tools_menu
            ;;
    esac
}

# Google search menu
google_search() {
    clear
    echo "====================================="
    echo "            Google Search"
    echo "====================================="
    echo -n "Enter search query: "
    read query
    echo "Searching Google for: $query"
    # Using the curl command to search
    curl "https://www.google.com/search?q=$query"
    main_menu
}

# Function to clone a new repository
clone_new_repository() {
    clear
    echo "====================================="
    echo "      Clone New Repository"
    echo "====================================="
    echo -n "Enter the GitHub repository URL: "
    read repo_url
    git clone $repo_url
    echo "Repository cloned successfully!"
    project_menu
}

# Function to view all repositories
view_repositories() {
    clear
    echo "====================================="
    echo "     View All Repositories"
    echo "====================================="
    # List all cloned repositories
    ls -d */
    project_menu
}

# Function to open all repositories in the tool section
open_all_repositories() {
    clear
    echo "====================================="
    echo "       Opening All Repositories"
    echo "====================================="
    for dir in */ ; do
        echo "Opening $dir"
        cd $dir
        # Open or run the repository (can be customized based on project needs)
        # Example: If it's a Python project, you could run it like this:
        # python3 main.py
        # Modify the command based on your repository types
        cd ..
    done
    tools_menu
}

# Start the login process
login
